<script>
  var query = window.location.search;
  if (query.charAt(0) === '?') {
    query = query.substring(1);
    var vars = query.split('&');
    for (var i = 0; i < vars.length; i++) {
      var pair = vars[i].split('=');
      if (pair[0] === 'token' && window.opener !== null) {
        window.opener.IVLE.loginHandler({
          success: true,
          authToken: pair[1]
        });
      } else {
        window.opener.IVLE.loginHandler({
          success: false,
          error: 'Failed to login.'
        });
      }
      window.close();
    }
  }
</script>
